<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dictators CRUD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Pacifico&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <style>
        h1 {
            font-family: "Pacifico", cursive;
            font-size: 5rem;
            font-weight: bold;
            text-align: center;
            color: #ff00ee;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-image: url('img/peakpx.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            color: #333;
        }
        #dictatorList > div {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            margin-bottom: 15px;
        }
        #dictatorList p {
            color: #333;
        }

        #dictatorList p.card-title {
            background-color: rgba(255, 105, 180, 0.7);
            padding: 5px;
            border-radius: 4px;
            font-weight: bold;
        }

        .btn-pink {
            background-color: #ff69b4; 
            color: white;
            border: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .btn-pink:hover {
            background-color: #ff1493;
        }
    </style>
    
    <script>
        let editingId = null;

        function fetchData() {
            fetch('https://67296e396d5fa4901b6d1e3f.mockapi.io/my_data')
                .then(response => response.json())
                .then(data => {
                    const dictatorList = document.getElementById('dictatorList');
                    dictatorList.innerHTML = '';
                    data.forEach(d => {
                        dictatorList.innerHTML += `
                            <div id="dictator-${d.id}">
                                <p class="card-title text-pink"><strong>${d.name} üéñüéñ</strong> - ${d.country}</p>
                                <p>Reign: ${d.reign_period}</p>
                                <p>Policy: ${d.famous_policy} üí™</p>
                                <p>Kill Count: ${d.kill_count}</p>
                                <button onclick="editData('${d.id}')" type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exampleModal">Edit ‚úèÔ∏è</button>
                                <button onclick="deleteData('${d.id}')" class="btn btn-danger">Delete ‚ùå</button>
                            </div>
                        `;
                    });
                });
        }

        function submitData(event) {
            event.preventDefault();

            const newData = {
                id: editingId || new Date().getTime().toString(),
                name: document.getElementById('addName').value,
                country: document.getElementById('addCountry').value,
                reign_period: document.getElementById('addReign').value,
                famous_policy: document.getElementById('addPolicy').value,
                kill_count: document.getElementById('addKillCount').value
            };

            if (editingId) {
                fetch(`https://67296e396d5fa4901b6d1e3f.mockapi.io/my_data/${editingId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(newData)
                })
                .then(response => response.json())
                .then(data => {
                    alert('Dictator updated successfully');
                    resetForm();
                    fetchData();
                });
            } else {
                fetch('https://67296e396d5fa4901b6d1e3f.mockapi.io/my_data', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(newData)
                })
                .then(response => response.json())
                .then(data => {
                    alert('Dictator added successfully');
                    resetForm();
                    fetchData();
                });
            }
        }

        function editData(id) {
            editingId = id;
            const dictatorDiv = document.getElementById(`dictator-${id}`);
            if (!dictatorDiv) {
                console.error('Dictator not found for ID:', id);
                return;
            }
            
            const name = dictatorDiv.querySelector('strong').innerText;
            const country = dictatorDiv.querySelector('p:nth-of-type(1)').innerText.split(' - ')[1];
            const reign = dictatorDiv.querySelector('p:nth-of-type(2)').innerText.split(': ')[1];
            const policy = dictatorDiv.querySelector('p:nth-of-type(3)').innerText.split(': ')[1];
            const killCount = dictatorDiv.querySelector('p:nth-of-type(4)').innerText.split(': ')[1];

            document.getElementById('editId').value = id;
            document.getElementById('addName').value = name;
            document.getElementById('addCountry').value = country;
            document.getElementById('addReign').value = reign;
            document.getElementById('addPolicy').value = policy;
            document.getElementById('addKillCount').value = killCount;

            document.getElementById('formTitle').innerText = 'ü©∞ Edit Dictator ü©∞';
            document.getElementById('submitButton').innerText = 'Update Dictator';
        }

        function deleteData(id) {
            if (confirm('Are you sure you want to delete this dictator?')) {
                fetch(`https://67296e396d5fa4901b6d1e3f.mockapi.io/my_data/${id}`, {
                    method: 'DELETE'
                })
                .then(response => response.json())
                .then(data => {
                    alert('Dictator deleted successfully');
                    fetchData();
                });
            }
        }

        function resetForm() {
            editingId = null;
            document.getElementById('editId').value = '';
            document.getElementById('addName').value = '';
            document.getElementById('addCountry').value = '';
            document.getElementById('addReign').value = '';
            document.getElementById('addPolicy').value = '';
            document.getElementById('addKillCount').value = '';

            document.getElementById('formTitle').innerText = 'Add New Dictator';
            document.getElementById('submitButton').innerText = 'Add Dictator';
        }

        fetchData();
    </script>
</head>
<body class="bg-light">
    <div class="container my-4">
        <h1 class="text-center">üíó‚ú®Dictators‚ú®üíó</h1>
        
        <section class="p-4 rounded shadow-sm">
            <div class="text-center mb-3">
                <button onclick="fetchData()" class="btn btn-warning">Refresh List</button>
                <button type="button" class="btn btn-pink" data-bs-toggle="modal" data-bs-target="#exampleModal">Add new dictator</button>
            </div>
            <div id="dictatorList" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3"></div>
        </section>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="formTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content" style="background-color: #fff0f6;">
                <div class="modal-header">
                    <h1 class="modal-title fs-5 text-pink" id="formTitle">üíñ Add a Dictator üíñ</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="resetForm()"></button>
                </div>
                <div class="modal-body">
                    <form id="addForm" onsubmit="submitData(event)">
                        <input type="hidden" id="editId">
                        <div class="mb-3">
                            <label for="addName" class="form-label">Name</label>
                            <input type="text" id="addName" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="addCountry" class="form-label">Country</label>
                            <input type="text" id="addCountry" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="addReign" class="form-label">Reign Period</label>
                            <input type="text" id="addReign" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="addPolicy" class="form-label">Famous Policy</label>
                            <input type="text" id="addPolicy" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="addKillCount" class="form-label">Kill Count</label>
                            <input type="text" id="addKillCount" class="form-control" required>
                        </div>
                        <div class="d-flex justify-content-end">
                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal" onclick="resetForm()">Close</button>
                            <button type="submit" id="submitButton" class="btn btn-primary" data-bs-dismiss="modal">Add Dictator</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    

    
</body>
</html>
